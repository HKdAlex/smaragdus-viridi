<!-- e292c32a-6f2e-4bb8-b22f-1b3a3a22143c a87f79b7-2232-458c-b25f-9660da5a2a21 -->
# Gemstone CRUD Audit Plan

## Objectives

- Catalogue every gemstone field across data model, admin UI, API, and services to confirm full CRUD coverage.
- Identify missing logic, UI, or validation needed for complete gemstone CRUD in the admin experience.
- Produce remediation guidance detailing required work to close identified gaps.

## Approach

1. **Data Model Survey**

- Parse gemstone-related schemas via `src/shared/types/database.ts`, Supabase migrations under `/migrations` and `/supabase/migrations`, and config constants like `src/shared/config/gemstone-properties.ts`.
- Record each gemstone field (core, AI-generated, media, relational) along with sources of truth and constraints (enums, defaults, RLS implications).

2. **Service & API Review**

- Inspect admin-facing logic in `src/features/admin/services` (e.g., `gemstone-admin-service.ts`, `media-upload-service.ts`, `gemstone-admin-api-service.ts`).
- Map which fields are handled for create/update/delete operations, bulk workflows, media management, and validation.
- Verify alignment with API routes under `src/app/api/admin/gemstones/**` and public catalog endpoints.

3. **Admin UI Audit**

- Examine components such as `admin-gemstone-manager.tsx`, `gemstone-form.tsx`, `gemstone-detail-page.tsx`, list views, bulk modals, and enhanced search filters.
- Track form inputs, tab coverage, interactions, and any missing UI for specific fields (e.g., AI content, certifications, quantity, metadata status).

4. **Auxiliary Workflow Check**

- Review related hooks (`src/features/gemstones/hooks/**`), utilities, and translation files to ensure CRUD data surfaces correctly.
- Assess bulk import/export flows (`bulk-import-modal.tsx`, CSV parser service) and media upload pathways for completeness per field.

5. **Testing & Safeguards Assessment**

- Locate Vitest/Playwright coverage for gemstone CRUD (e.g., `src/features/admin/services/__tests__`, any E2E specs) to note gaps.
- Confirm RLS policies or auth middleware allow required admin actions without exposing service-role keys client-side.

6. **Synthesize Findings**

- Draft `docs/gemstone-crud-inventory.md` capturing each field with CRUD coverage status, responsible layers (UI/service/API/DB), gaps, and recommended fixes.
- Produce `docs/gemstone-crud-remediation-plan.md` outlining prioritized implementation steps, dependencies, validation/testing updates, and risk mitigations.

## Deliverables

- `docs/gemstone-crud-inventory.md`
- `docs/gemstone-crud-remediation-plan.md`

## Risks & Mitigations

- **Incomplete Schema Insight**: Mitigate by cross-referencing migrations and Supabase types; flag uncertainties explicitly.
- **Outdated UI Components**: Validate component usage through admin routes to avoid documenting deprecated flows.
- **Hidden Business Rules**: Search services/hooks for derived logic; include notes where behavior inferred rather than explicit.

## Dependencies

- Access to Supabase type definitions and admin component implementations.
- Accurate understanding of admin vs public gemstone flows (confirmed: admin-focused).

## Success Criteria

- Field inventory lists every gemstone-related attribute with CRUD coverage status and references.
- Remediation plan clearly enumerates actionable tasks to achieve full CRUD parity, including validation, RLS, and testing.

### To-dos

- [ ] Extract gemstone field definitions and constraints from Supabase types and migrations.
- [ ] Review gemstone admin services and API routes for CRUD handling of each field.
- [ ] Map UI coverage for gemstone fields across forms, detail views, lists, and bulk tools.
- [ ] Evaluate existing tests, RLS, and auth safeguards for gemstone CRUD flows.
- [ ] Author inventory and remediation plan markdown documents summarizing findings and gaps.